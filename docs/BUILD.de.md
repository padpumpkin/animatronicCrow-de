![Crow parts everywhere](images/AniCrow030.jpg)
# Bauanleitung #
___
## Stückliste: ##

### Krähe ###

| Menge | Teil                     | Hinweis                                                                                                                           |
|-----|--------------------------|--------------------------------------------------------------------------------------------------------------------------------|
| 2   | 5mm rote LEDs             | Für die Augen. Ich verwende diffuse (frosted) LEDs.                                                                                              |
| 1   | SG90 5V Servo            |                                                                                                                                |
| 1   | 28BYJ-48 5V Stepper      | Wenn du die CC5x12-Steppersteuerung nutzt, brauchst du das Breakout-Board nicht (du könntest dessen Bauteile aber auf die CC5x12 umziehen). |
| 1   | 40mm 4Ω, 3W Lautsprecher      | 8 Ω funktionieren ebenfalls.                                                                                                                  |
| 1   | Micro SD-Karte            | Für die MP3-Audiodateien.                                                                                                       |
| 1   | HC-SR312 AM312 Mini PIR  | Optional. Bewegungssensor. LD1020-Radarsensor wird demnächst getestet.                                                          |
| 3   | Kabel/Steckverbinder         | Zwei 2-adrige und ein 3-adriges Kabel für Lautsprecher, LEDs und PIR. CC5x12 nutzt 2,54 mm-Stiftleisten (oder direkt anlöten). |
| 1   | Große Büroklammer          | ~1.25mm Drahtstärke.                                                                                                                 |
| 1   | 2mm Stab                  | ca. 15 mm lang für das Schnabel-Gelenk. Ich nutze Carbon, anderes Material geht auch. Anmerkung: padpumkin: Ich habe hier ein Stück Filamnet verwendet                     |
| 9   | M3x4x5 Einschmelzgewinde | 5 mm hohe Einsätze (M3x5x5) passen ebenfalls.                                                                                       |
| 11  | M3-Schrauben                | 5× 8 mm für Kopf/Schwanz, 4× 6 mm für Stepper/PCB, 2× 5 mm Senkkopf für den Körper (normale 6 mm gehen meist auch). |
| 2   | M3-Muttern                  | Für die Stepper-Kupplung im Kopf.                                                                                      |
| 8   | Magnete 10×3 mm         | Neodym, hochfest, zur Befestigung des Schwanzes am Körper.                                                                    |
|     | Heißkleber                 | Schwarz bevorzugt.                                                                                                               |
|     | Füllwatte (Polyfill)                 | Ein wenig zur Dämpfung im Lautsprechergehäuse..                                                                      |

### [Creature Control 5x12] ###
Beachte: Die CC5x12-Platine wird für dieses Projekt nicht vollständig bestückt.
Die CC5x12 bietet mehrere Optionen zur Einspeisung der 5 V-Schiene.

***Es darf immer nur eine Einspeisung gleichzeitig angeschlossen sein.***

Der RP2040-Zero kann mit Strom (inkl. PC-USB) verbunden sein, während die 5 V-Schiene separat versorgt wird.

| Menge          | Teil                                | Hinweis                                                                      |
|--------------|-------------------------------------|---------------------------------------------------------------------------|
| 1            | RP2040-Zero                         | Waveshare oder gleichwertig.                                              |
| 1            | DFPlayer Mini                       | DFRobot oder gleichwertig.                                                |
| 3            | 100 nF/50 V Keramik (104)   | (v1.1+) für DFPlayer-VCC, (v1.2) Eingang 5 V, ULN2003A.                 |
| 1            | 1 µF/50 V Keramik (105)     | (v1.2) Mittelfrequenz-Filter für den DFPlayer Mini.                                 |
| 1            | 220 µF/10–16 V Elektrolyt | (v1.2) für DFPlayer Mini ([oder Anpassung älterer Versionen](MaxVolBodge.de.md)). |
| 1            | 1 kΩ Widerstand                        | (v1.1+) für MCU GP0 → DFPlayer Mini RX.                                     |
| 1            | IC-Sockel DIP-16                | Für ULN2003A.                                                             |
| 1            | ULN2003A                            |                                                                           |
| 1            | XH2.54-5-Pin Buchse            | Gerade, für Stepper.                                                 |
| 1            | 1N5819 Schottky-Diode               | Für RP2040-Zero VCC.                                                      |
| 1 (optional) | 3mm LED                             | Power-Rail-Anzeige.                                                 |
| 1 (optional) | Widerstand für obige LED              | Ich nutze 2,2 kΩ für eine blaue 3 mm-LED.                                          |
| 1            | Widerstand für die Augen-LEDs               | Ich nutze 2,2 kΩ für ein Paar rote 5 mm-LEDs (parallel).              |
| 1            | 1 µF/50 V Keramik (105)     | Für ULN2003A (auf v1.0 im Silkscreen falsch bezeichnet).                                  |
| 2            | 100 µF/16 V Elektrolyt    | Für Servo und Stepper.                                                    |
| 1            | 1000 µF/16 V Elektrolyt   | Für die 5 V-Schiene.                                                              |
| 1 (optional) | 5,5×2,1 mm DC-005 Hohlbuchse         | Wenn 5 V/3 A-Netzteil verwendet wird.                                                 |
| 1 (optional) | USB-C 6-Pin SMD-Buchse           | Wenn USB-Powerbank genutzt wird.                                                   |
| 2 (optional)  | 5,1 kΩ Widerstände                     |Falls USB-C-Versorgung genutzt wird.                                                   |
| (optional)     | 2,54 mm Stiftleisten                  | Falls Leitungen nicht direkt auf die Platine gelötet werden.                                |

___
## Kopf ##

![Crow Head Parts](images/AniCrow018.jpg)

|                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![LEDs für die Krähen Augen](images/AniCrow017.jpg)                                                                             | Beginne mit den LEDs. Der Vorwiderstand sitzt auf der Platine, daher werden die beiden LEDs parallel verdrahtet. Ich nutze einen 2-adrigen Stecker (Ende abgeschnitten, abisoliert), dazu kurze hochtemperaturfeste Leitungen und Schrumpfschlauch..                                                                                                                                                                            |
| ![Gelötete LEDs für Krähen Augen](images/AniCrow016.jpg)                                                                    | Löte die LEDs „gestapelt“, d. h. Plus an Plus / Minus an Minus und verbinde das mit der entsprechenden Zuleitung. Offene Stellen mit Schrumpfschlauch oder Isoband abdecken.                                                                                                                                                                                                                                             |
| ![Krähe LED Augen Test](images/AniCrow015.jpg)                                                                             | Vor dem Einbau mit test-servo.ino auf deiner CC5x12 testen. Beide Augen sollten leuchten und alle 4 s blinken.                                                                                                                                                                                                                                                                                                     |
| ![Krähe LED Augen eingesetzt](images/AniCrow014.jpg)                                                                        | LEDs vorsichtig in die Fassungen einsetzen und so biegen, dass die Kabel sauber nach hinten innen am Kopf verlaufen. Tiefe optisch anpassen (nicht ganz bis zum Anschlag drücken).                                                                                                                                                                                                                                        |
| ![Krähe LED Augen verklebt](images/AniCrow013.jpg)                                                                            | Wenn alles sitzt, LEDs und Steck-/Lötstellen mit Heißkleber fixieren. Komplett auskühlen lassen.                                                                                                                                                                                                                                                                                                     |
| ![Krähe Aktuatorteile](images/AniCrow067.jpg)                                                                            | Der Aktuator besteht aus vier kleinen Druckteilen. Empfehlung: 0,2 mm-Düse für Stabilität und Genauigkeit. Die Metallteile stammen aus einer großen Büroklammer (~1,25 mm).                                                                                                                                                                                                                                                          |
| ![Aktuator Scharnierstift](images/AniCrow065.jpg)                                                                             | Der Scharnierstift für den Schnabel muss 21,5 mm lang sein (21–21,6 mm ok) und sauber gerundete Enden haben. Falls möglich mit Mikrometer messen und Enden mit Schleifer/Feile runden.                                                                                                                                                                                                  |
| ![Aktuator Servo Verbindung](images/AniCrow068.jpg)                                                                      | Ein zweites Stück (~20 mm, Enden ebenfalls rund) im scharfen 90°-Winkel biegen. Je enger, desto besser.                                                                                                                                                                                                                                                                                                                                  |
| ![Montierter Aktuator](images/AniCrow066.jpg)                                                                             | So sieht der montierte Aktuator aus. Das 90°-Teil sollte einrasten; ein Hauch Kleber schadet nicht.                                                                                                                                                                                                                                                                                                                       |
| ![Linke Seite vom Aktuartor Stift zuerst einsetzen](images/AniCrow064.jpg)                                                       | Für den Einbau des Aktuators in den Schnabel das Kunststoffteil etwas biegen. Zuerst die lange (linke) Seite wie gezeigt in die Bohrung einsetzen.                                                                                                                                                                                                                                                                              |
| ![Schnabel leicht nach außen drück und rechte Seite vom Stift einsetzen](images/AniCrow063.jpg)                                              | Gleichzeitig den Aktuator nach unten drücken und die rechte Schnabelseite leicht nach außen drücken, dann den Stift in die zweite Bohrung schwenken.                                                                                                                                                                                                                                                                                                  |
| ![Krähe Schnabel Scharnierstift einbau](images/AniCrow012.jpg)                                                                    | Ich nutze einen 2 mm Graphitstab; jedes 2 mm-Material geht. Minimal länger als die Stütze zuschneiden und Enden verrunden. Von rechts einschieben ist etwas einfacher. Vorsicht: die kleinen Türmchen sind filigran. Anmerkung padpumpkin: Ich habe ein Stück 1.75mm Filament verwendet, das funktioniert auch                                                                                                                                                                            |
| ![Schnabel und Aktuator an Servoplatte montiert](images/AniCrow062.jpg)                                                      | Schnabel, Servoplatte und Aktuator müssen sich frei bewegen. (Trocken-)Schmierstoff auf die Schnabelachsen und die Gleitfläche an der Halteplatte geben. Hinweis: Der Aktuator berührt die Schnabelachse nicht.                                                                                                                                                                                              |
| ![Reset der Servoposition](images/AniCrow003.jpg)               | Aktuator an die CC5x12 anschließen. 5 V-Schiene mit Strom versorgen und USB zum PC verbinden. [test-servo](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/test-servo) kompilieren/hochladen und den Serial Monitor öffnen. Der Servo fährt in Grundstellung und durchläuft Sequenzen. Strom trennen, wenn der Servo bei „0“ steht.                 |
| ![Servoarm an unterster Positon montieren](images/AniCrow061.jpg)                                                            | Servo mit Kabeln zur Platte einbauen und mit zwei Schrauben befestigen. Schnabel ganz nach unten drücken, Spacer auf den Aktuatorstift, einarmigen Servohebel im vorletzten Loch einhängen. Hebel so tief wie möglich aufsetzen, ohne die Platte zu berühren oder die Zahnräder zu verspannen. Schraube montieren.                                                           |
| [![Grenzbereiche in der Software prüfen](images/AniCrow020.png)](https://youtube.com/shorts/lqEB10gqAUw) (YouTube Video Link) | Servoplatte mit ein paar M3-Schrauben am Kopf befestigen, CC5x12 wieder anschließen. Läuft alles, öffnet/schließt der Schnabel nun.<br/><br/>Klickt/knirscht der Servo bei offenem Schnabel, Verbindung am Servoarm prüfen.<br/><br/>beakCloseDeg anpassen und erneut hochladen, bis der Schnabel ohne Schleifgeräusche ganz öffnet/schließt. Etwa 0° und 45°. Kleine Änderungen wirken. |
| ![Befestigungschrauben an der Stepper-Kupplung montieren](images/AniCrow024.jpg)                                                    | Oberflächen innen an der Stepper-Kupplung glattschleifen und trocken-schmieren. Zwei M3-Muttern in die Nuten legen. Zwei M3×8-Schrauben eindrehen (Zugang über die Seitenbohrungen per 2 mm Innensechskant), bis sie gerade an den Stepper-Zapfen heranreichen.                                                                                                                                                                              |
| ![Zusammenbau](images/AniCrow001.jpg)                                                                                       | Kabel durch die Platten führen. Teile stapeln und mit zwei M3×8-Schrauben verbinden. Der Kopf ist einsatzbereit.                                                                                                                                                                                                                                                                                     |

___
## Körper ##

![Krähe Körper Komponentne](images/AniCrow032.jpg)

|                                                                      |                                                                                                                                                                                                                                                                                                                                    |
|----------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ![Einsetzen der Gewindeeinsätze](images/AniCrow031.jpg)               | Sieben Einschmelzgewinde einsetzen: zwei für die Stepper-Platte, zwei für den Stepper, zwei für die PCB, eines für den Schwanz-Tab.                                                                                                                                                                                                        |
| ![Füße kleben](images/AniCrow038.jpg)                           | Füße ankleben. Ich nutze 2-K-Epoxy mit längerer Topfzeit. Fußaufnahmen und Zapfen benetzen, einsetzen, die Krähe auf eine ebene Fläche stellen und die Füße mit leichtem Druck am Körper feinjustieren. Aushärten lassen.                                                               |
| ![Tab in Schwanz einrasten](images/AniCrow051.jpg)                    | Der Schwanz-Tab ist als Schnappverbindung ausgelegt. Mit Nachdruck einrasten lassen.                                                                                                                                                                                                                                         |
| ![Schwanz Tab montiert](images/AniCrow033.jpg)                         | Mit eingesetztem Tab ist der Schwanz bereit zur Montage.                                                                                                                                                                                                                                                                                   |
| ![Lautsprecher vorbereiten](images/AniCrow034.jpg)                        | Lautsprecher verkabeln. Ich habe das Ende eines 2-Pin-Standardsteckers abgetrennt und die Litzen direkt an den Lautsprecher gelötet. Nach dem Verkleben sollten die Leitungen nicht auf Zug sein.                                                                                                                                     |
| ![Lautsprecherkabel verlegen](images/AniCrow037.jpg)                     | Das Lautsprecherkabel führt durch ein schräges Loch aus der Box. Ich habe etwas lose Füllwatte in die Kammer gelegt, um Resonanzen zu dämpfen.                                                                                                                                                      |
| ![Lautsprecher bereit zum Einbau](images/AniCrow041.jpg)                   | Sitz des Lautsprechers trocken testen, bevor Heißkleber aufgetragen wird.                                                                                                                                                                                                                                                        |
| ![Lautsprecher festkleben](images/AniCrow043.jpg)                      | Mit einer dünnen Heißkleberraupe entlang der Kante beginnen und den Lautsprecher zügig einsetzen.                                                                                                                                                                                                                                           |
| ![Verbindung zum Gehöuse abdichten](images/AniCrow042.jpg)                        | Anschließend eine geschlossene Heißkleber-Raupe ums gesamte Chassis ziehen, um (möglichst) luftdicht zu versiegeln.                                                                                                                                                                                                                                        |
| ![Kabel durch Bohrung führen und abdichten](images/AniCrow044.jpg)  | Kabel unter dem Loch durch den Ring führen und die Öffnung bestmöglich mit Heißkleber verschließen.                                                                                                                                                                                                                          |
| ![Stepper-Halterung vorbereiten](images/AniCrow046.jpg)        | Der Kopf dreht auf zwei Zapfen unten an der Stepper-Halterung. Ich schleife diese und den großen Gleitbogen an der Kopf-Kupplung bis 800er Korn und versehe beide mit trockenem PTFE-Schmierstoff.                                                                         |
| ![Stepper montieren](images/AniCrow069.jpg)             | Stepper mit zwei M3×6 montieren. Die Platte befestige ich mit zwei M3×5 Senkkopf am Körper; normale M3×6 funktionieren in der Regel ebenfalls.                                                                                                                                                                     |
| ![Stepper-Kabel durchführen](images/AniCrow045.jpg)    |Für das Stepperkabel sind lange Spitzzangen hilfreich. Kabel seitlich biegen und den Stecker durch denselben Ring führen, durch den auch die Lautsprecherleitung läuft.                                                                                                                                      |
| ![Stepper an Platte befestigen](images/AniCrow040.jpg)                   | Stepper-Platte mit M3-Schrauben am Körper befestigen.                                                                                                                                                                                                                                                                         |
| ![Sensor vorbereiten](images/AniCrow048.jpg)                         | *Hinweis: LD1020-Modelle und Anleitung folgen.*<br/><br/>PIR-Front mit 0,2 mm-Düse ggf. liegend drucken. Es ist wenig Platz fürs Kabel – entweder die Stiftleiste senkrecht einsetzen oder (wie hier gezeigt) abwinkeln (riskant). Etwas Heißkleber verhindert, dass sich etwas löst. |
| ![Sensor einbauen](images/AniCrow049.jpg)                         | Die Montage ist fummelig und erfordert leichtes Flexen des Halters. Vorher trocken mit leerem Halter üben. Zum Lösen den kleinen Pfeiler (grüner Pfeil) mit einer Zange greifen und nach oben ziehen.                                                                                                 |
| ![Shiel größzügig einkleben](images/AniCrow050.jpg)              | Ich habe das „Shield“ recht großzügig mit Heißkleber versehen. Es soll verhindern, dass der PIR durch die Eigenbewegung (Kopf/Nacken) auslöst. Evtl. ist es gar nicht nötig (?).                                                                                                                                                             |
| ![Kopf montieren](images/AniCrow039.jpg)                            | Kopf auf den Stepper setzen und die Oberkante (grüner Pfeil) mit Karton unterlegen (shim). Mit 2 mm-Innensechskant über die seitlichen Zugangsbohrungen abwechselnd rechts/links erst handwarm und dann fest anziehen.                                                                                     |
| ![Bereit für die Platine](images/AniCrow052.jpg)                              | Jetzt sollten alle Leitungen hinten aus dem Körper herausführen.                                                                                                                                                                                                                                                      |
| ![Montageschiene an der Platine befestigen](images/AniCrow053.jpg)         |Die PCB-Montageschiene mit M3×6 an der Platine befestigen. Überlange Lötbeinchen unter/nahe der Schiene bündig kürzen.<br/><br/>MP3-Dateien jetzt auf die SD-Karte kopieren – später kommt man nur durch teilweises Herausziehen an den Slot.                                                                                      |
| ![Krähe auf dem Rücken](images/AniCrow060.jpg)                        | Krähe auf den Rücken legen – am besten auf ein T-Shirt/ weiches Tuch gegen Kratzer.                                                                                                                                                                                                                                          |
| ![Servo-, Lautsprecher- und LED-Leitungen verbinden](images/AniCrow059.jpg) | LED-, Lautsprecher- und Servo-Leitungen verbinden. Auf Polarität achten (Servo braun = GND).                                                                                                                                                                                                                                         |
| ![Stepper und Sensor anschließen](images/AniCrow058.jpg)                  | Platine teilweise einschieben und Stepper/Sensor verbinden.                                                                                                                                                                                                                                                          |
| ![Platine einschieben](images/AniCrow057.jpg)       | Platine vollständig einschieben, bis sie anschlägt und die Schiene einrastet.                                                                                                                                                                                                                                              |
| ![](images/AniCrow056.jpg)                                           | Krähe umdrehen. Externe Leitungen durch das Loch im Schwanz führen und diesen hinten am Körper befestigen.                                                                                                                                                                                                             |
| ![](images/AniCrow055.jpg)                                           | Der Schwanz kann zusätzlich mit einer M3×8 durch das Loch zwischen den Flügeln (vor dem Schwanz) gesichert werden.                                                                                                                                                                                                        |
| ![](images/AniCrow054.jpg)                                           | Statt eines Kabels kann ein Akku vorsichtig im Körper platziert werden (keine Bauteile beschädigen/kurzschließen) – so wird das Modell autark.                                                                                                                                                                      |

___
## Software ##
Kopiere den Ordner mp3 auf deine SD-Karte.

Installiere die [Arduino IDE](https://www.arduino.cc/en/software/) und folgende Bibliotheken:
[AccelStepper](https://www.airspayce.com/mikem/arduino/AccelStepper),
[DFRobotDFPlayerMini](https://github.com/DFRobot/DFRobotDFPlayerMini),
[arduino-pico](https://github.com/earlephilhower/arduino-pico) by Earle Philhower,
[Adafruit NeoPixel](https://github.com/adafruit/Adafruit_NeoPixel). 
All diese Libraries sind normalerweise über den Library Manager der Arduino-IDE installierbar.

Aktiviere im Board-Manager das Waveshare RP2040-Zero Board.

hließe den RP2040-Zero an den PC an, wähle das Gerät aus und setze das Board auf Waveshare RP2040-Zero.
Öffne den gewünschten Sketch und klicke auf Upload.

### Sketches ###
* [animatronic-crow](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/animatronic-cros): Hauptsoftware für deinen Vogel. Du brauchst die Werte für Lautstärke, Stepper-Geschwindigkeit und Schnabel-Schließwinkel, um sie für deine Krähe zu konfigurieren. Verbunden mit dem PC erscheinen Statusmeldungen im Serial Monitor.
  * __TEST_MODE__ Augen leuchten, wenn der Sensor auslöst (praktisch zum Tuning der Timeouts).
  * __USE_LD1020__ wenn Radarsensor genutzt wird – sonst löst die Krähe ihre eigenen Bewegungen in einer (sehr) engen Schleife aus.
  * __DFPLAYER_VOLUME__ theoretisch max. 30; die echte Obergrenze hängt von Versorgung, Speaker etc. ab. Am besten mit test-animations prüfen (ggf. auf Akku, wenn das der Zielbetrieb ist). Wenn Sound aussetzt, schrittweise reduzieren.
  * __LD1020_ANIMATION_COOLDOWN_MS__ Hauptregler für „Wie reaktiv soll die Krähe sein?“ bei Radar.
  * __SCOLD_SQUAWK_BLOCK_MS__ Hauptregler für „Wie reaktiv soll die Krähe sein?“ bei PIR.
  * __IDLE_MOVE__ and __IDLE_SQUAWK__ Aktivität der Krähe ohne Trigger.
  * __BLINK__ Blinkfrequenz der Augen.
  * __NECK*__ Bereich nicht ändern; ggf. schnelle Geschwindigkeit nach test-stepper anpassen.
  * __PIN__ Definitionen ändern, wenn du nicht CC5x12-Sensor1/Servo1/Stepper1/LED1 nutzt.
* [test-animations](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/test-animations): Sound prüfen, Lautstärke testen, Animationen ansehen. Schimpfen/Krächzen abspielen und Volume im Serial Monitor setzen.
* [test-sensor](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/tes-sensor): Einfacher Sketch – Augen leuchten, wenn der Sensor auslöst. Hilft, die Empfindlichkeit zu verstehen/visualisieren.
* [test-servo](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/test-servo): Servo fährt alle 4 s 0° → 50 % → 100 % → 0°. Notwendig, um den Schnabel-Schließwinkel zu bestimmen. Details im Serial Monitor. Augen blinken zu jeder Bewegung.
* [test-stepper](https://github.com/swaziloo/halloween/blob/main/animatronicCrow/ino/test-stepper): Verschiedene Tests, um Max Speed und Acceleration des Nacken-Steppers zu finden. Details im Serial Monitor.

